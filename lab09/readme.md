# Лабораторная работа №9

В чем состоит суть данной лабораторной работы? Мы уже умеем создавать процедуры и делать в них различные манипуляции по типу запросов и проверок входных данных, но вывод результата у нас пока доступен только в одном виде - запись в таблицу `log_file`. Например, нам в задании сказали посчитать среднюю цену по товару "Папки" – мы посчитали нужное число, записали его в `log_file` и потом убедились, что оно там есть, открыв данную таблицу. 

А что, если мы хотим именно возвращать данные из процедуры? То есть не писать в какую-то таблицу, а сразу получать результат при вызове процедуры? Такая возможность есть, и она будет рассмотрена в данной лабораторной работе.

Стоит отметить один момент: во всех решениях задач объявление входных и выходных параметров, а также локальных переменных происходит через код, а не с помощью графического интерфейса. Вы можете делать так, как вам удобнее - если вы больше предпочитаете графический интерфейс, то тогда все переменные можно внести через него, а код уже будете писать в секции begin-end.


### [Как писать процедуры?](https://github.com/NikitaBogoslovskiy/DatabaseCourse/tree/main/lab09/how-to-create-procedures.md)

В этом блоке кратко описано и проиллюстрировано, как создавать процедуру. Возможно, многие уже и так это знают, но для закрепления лишним не будет + при решении задач дальше мы следуем структуре, которая описана в этом блоке.

### [Задача №3](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_3.md)

В этом блоке приведено максимально подробное описание решения задачи. Объявление переменных, проверка входных параметров, написание SQL-запроса, вывод итоговой таблицы - все это рассмотрено с комментариями и пояснениями. Последующие задачи так подробно рассматриваться не будут, поэтому если вы хотите разобраться, как писать процедуру, то этот блок для вас. Да, там много текста, но не пугайтесь :) Сама задача простая и решается несложно, просто надо один раз изучить решение, и дальше все можно будет делать по образу и подобию. Если вам нужно только решение, то оно находится в самом низу.

Разобрав эту задачу, вы получите общее представление о том, как должны выглядеть процедуры, возвращающие таблицы, а также сможете решить задачи 1-5 (третья уже разобрана), 8.


### [Задача №7](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_7.md)

В этом блоке рассматривается уже более лаконичное решение задачи №7. Здесь мы рассматриваем, как работать с текстовыми запросами, то есть с запросами, записанными в виде строки.

Разобрав эту задачу, вы сможете выполнить задачи 6-7 (седьмая уже разобрана).

### Комментарии к остальным задачам

#### Задача №1

Формирование SQL-запроса сильно похоже на то, что было описано в [Задаче №3](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_3.md), в разделе [2.ii. Решение основной задачи](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_3.md#%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D0%BE%D0%B9_%D0%B7%D0%B0%D0%B4%D0%B0%D1%87%D0%B8).

#### Задача №2

Сильно похожа на [Задачу №3](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_3.md). Проверка входных данных необязательна.

#### Задача №6

Упрощенная версия [Задачи №7](https://github.com/NikitaBogoslovskiy/DatabaseCourse/blob/main/lab09/task_7.md). Если из процедуры нужно вернуть только одно значение, то тогда можно опустить цикл for и просто сделать следующее:
```sql
execute statement :operation into :output_variable;
suspend;
```
Процедура по-прежнему вернет таблицу, просто она будет содержать одну строку и один столбец, то есть одно выходное значение.

